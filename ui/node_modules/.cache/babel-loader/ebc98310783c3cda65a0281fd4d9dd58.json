{"ast":null,"code":"import _regeneratorRuntime from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2;import React,{useEffect,useState}from\"react\";import styled from\"styled-components\";import*as Colors from\"../styles/colors\";import H3 from\"../styles/H3\";import Transaction from\"./Transaction\";import getWeb3 from\"../utils/getWeb3\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HomeContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  padding: 1rem 2rem;\\n\"])));var TransactionsBox=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  padding: 1rem;\\n  border-radius: 1rem;\\n  font-family: \\\"Ubuntu Mono\\\", monospace;\\n  margin-bottom: 1.25rem;\\n  font-size: 1em;\\n\"])),Colors.CHOCOLATE_200);var Home=function Home(_ref){var port=_ref.port;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),transactions=_useState2[0],setTransactions=_useState2[1];var getPendingTransactions=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var web3,subscription;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getWeb3(port);case 2:web3=_context2.sent;subscription=web3.eth.subscribe('pendingTransactions');subscription.subscribe(function(error,result){if(error)console.log(error);}).on('data',/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(txHash){var txn,transaction;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return web3.eth.getTransaction(txHash);case 3:txn=_context.sent;transaction=/*#__PURE__*/_jsx(Transaction,{transaction:txn,port:port},Date.now());_context.next=7;return setTransactions(function(prev){return[].concat(_toConsumableArray(prev),[transaction]);});case 7:return _context.abrupt(\"return\",function cleanup(){subscription.unsubscribe();});case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref3.apply(this,arguments);};}());case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function getPendingTransactions(){return _ref2.apply(this,arguments);};}();useEffect(function(){getPendingTransactions();},[]);return/*#__PURE__*/_jsxs(HomeContainer,{children:[/*#__PURE__*/_jsx(H3,{children:\"Transactions\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Transactions will be listed below as they are created.\"}),transactions.length?transactions.filter(function(v,i){if(i%2){return v;// uber hack to only display even (given the subscription is returning dupes)\n}}):/*#__PURE__*/_jsx(TransactionsBox,{children:\"Waiting for transactions\"})]});};export default Home;","map":{"version":3,"sources":["/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/src/components/Home.tsx"],"names":["React","useEffect","useState","styled","Colors","H3","Transaction","getWeb3","HomeContainer","div","TransactionsBox","CHOCOLATE_200","Home","port","transactions","setTransactions","getPendingTransactions","web3","subscription","eth","subscribe","error","result","console","log","on","txHash","getTransaction","txn","transaction","Date","now","prev","cleanup","unsubscribe","length","filter","v","i"],"mappings":"4nCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,MAAO,GAAKC,CAAAA,MAAZ,KAAwB,kBAAxB,CACA,MAAOC,CAAAA,EAAP,KAAe,cAAf,CACA,MAAOC,CAAAA,WAAP,KAAwB,eAAxB,CACA,MAAOC,CAAAA,OAAP,KAAoB,kBAApB,C,wFAEA,GAAMC,CAAAA,aAAa,CAAGL,MAAM,CAACM,GAAV,0FAAnB,CAIA,GAAMC,CAAAA,eAAe,CAAGP,MAAM,CAACM,GAAV,6NACLL,MAAM,CAACO,aADF,CAArB,CASA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAiB,IAAfC,CAAAA,IAAe,MAAfA,IAAe,eACYX,QAAQ,CAAQ,EAAR,CADpB,wCACrBY,YADqB,eACPC,eADO,eAG5B,GAAMC,CAAAA,sBAAsB,2FAAG,qLAEVT,CAAAA,OAAO,CAACM,IAAD,CAFG,QAEvBI,IAFuB,gBAGvBC,YAHuB,CAGRD,IAAI,CAACE,GAAL,CAASC,SAAT,CAAmB,qBAAnB,CAHQ,CAK7BF,YAAY,CAACE,SAAb,CAAuB,SAACC,KAAD,CAAaC,MAAb,CAA6B,CAClD,GAAID,KAAJ,CAAWE,OAAO,CAACC,GAAR,CAAYH,KAAZ,EACZ,CAFD,EAGCI,EAHD,CAGI,MAHJ,2FAGY,iBAAOC,MAAP,4KAGUT,CAAAA,IAAI,CAACE,GAAL,CAASQ,cAAT,CAAwBD,MAAxB,CAHV,QAGFE,GAHE,eAKFC,WALE,cAMN,KAAC,WAAD,EAAa,WAAW,CAAED,GAA1B,CAA+B,IAAI,CAAEf,IAArC,EAAgDiB,IAAI,CAACC,GAAL,EAAhD,CANM,uBASFhB,CAAAA,eAAe,CAAC,SAACiB,IAAD,CAAe,CACnC,mCAAWA,IAAX,GAAiBH,WAAjB,GACD,CAFoB,CATb,wCAaD,QAASI,CAAAA,OAAT,EAAmB,CACxBf,YAAY,CAACgB,WAAb,GACD,CAfO,4DAkBRX,OAAO,CAACC,GAAR,cAlBQ,qEAHZ,iEAL6B,wDAAH,kBAAtBR,CAAAA,sBAAsB,2CAA5B,CA+BAf,SAAS,CAAC,UAAM,CACde,sBAAsB,GACvB,CAFQ,CAEN,EAFM,CAAT,CAIA,mBACE,MAAC,aAAD,yBACE,KAAC,EAAD,2BADF,cAEE,6EAFF,CAGKF,YAAY,CAACqB,MAAb,CACCrB,YAAY,CAACsB,MAAb,CAAoB,SAACC,CAAD,CAAGC,CAAH,CAAS,CAC3B,GAAIA,CAAC,CAAC,CAAN,CAAS,CACP,MAAOD,CAAAA,CAAP,CAAU;AACX,CACF,CAJD,CADD,cAME,KAAC,eAAD,uCATP,GADF,CAaD,CAnDD,CAqDA,cAAezB,CAAAA,IAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport * as Colors from \"../styles/colors\";\nimport H3 from \"../styles/H3\";\nimport Transaction from \"./Transaction\";\nimport getWeb3 from \"../utils/getWeb3\";\n\nconst HomeContainer = styled.div`\n  padding: 1rem 2rem;\n`;\n\nconst TransactionsBox = styled.div`\n  background: ${Colors.CHOCOLATE_200};\n  padding: 1rem;\n  border-radius: 1rem;\n  font-family: \"Ubuntu Mono\", monospace;\n  margin-bottom: 1.25rem;\n  font-size: 1em;\n`;\n\nconst Home = ({port}: any) => {\n  const [transactions, setTransactions] = useState<any[]>([]);\n\n  const getPendingTransactions = async () => {\n\n    const web3 = await getWeb3(port);\n    const subscription = web3.eth.subscribe('pendingTransactions');\n\n    subscription.subscribe((error: any, result: any) => {\n      if (error) console.log(error)\n    })\n    .on('data', async (txHash: any) => {\n\n      try {\n        const txn = await web3.eth.getTransaction(txHash)\n\n        const transaction: any = (\n          <Transaction transaction={txn} port={port} key={Date.now()} />\n        );\n       \n        await setTransactions((prev: any) => {\n          return [...prev, transaction];\n        });\n\n        return function cleanup() {\n          subscription.unsubscribe();\n        };\n      }\n      catch (error) {\n        console.log(error)\n      }\n    })\n  }\n\n  useEffect(() => {\n    getPendingTransactions();\n  }, []);\n\n  return (\n    <HomeContainer>\n      <H3>Transactions</H3>\n      <p>Transactions will be listed below as they are created.</p>\n        {transactions.length ? \n          transactions.filter((v,i) => {\n            if (i%2) {\n              return v; // uber hack to only display even (given the subscription is returning dupes)\n            }\n          }) \n        : (<TransactionsBox>Waiting for transactions</TransactionsBox>) }\n    </HomeContainer>\n  );\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}