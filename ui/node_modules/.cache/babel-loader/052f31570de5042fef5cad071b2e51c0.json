{"ast":null,"code":"import _regeneratorRuntime from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectDestructuringEmpty from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";import _taggedTemplateLiteral from\"/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14;import React,{useEffect,useState}from'react';import axios from\"axios\";import styled from\"styled-components\";import H3 from\"../styles/H3\";import PrimaryButton from\"../styles/PrimaryButton\";import Sources from\"./Sources\";import Variables from\"./Variables\";import Tray from\"./Tray\";import StatusIcon from\"./StatusIcon\";import StatusMessage from\"./StatusMessage\";import Tabs from\"./Tabs\";import DebugTooltip from\"./DebugTooltip\";import KeyboardShortcuts from\"./KeyboardShortcuts\";import List from\"../styles/List\";import*as Colors from\"../styles/colors\";import Loading from\"../styles/Loading\";import TruffleDebugger from\"@truffle/debugger\";import*as Codec from\"@truffle/codec\";import{getTransactionSourcesBeforeStarting}from\"@truffle/debug-utils\";import Provider from\"@truffle/provider\";import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DebuggerWrapper=styled(List)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  height: 90vh;\\n  display: grid;\\n  grid-template-rows: auto auto auto 1fr;\\n  grid-template-columns: 1fr;\\n  padding: 1rem 2rem;\\n\"])));var Header=styled(H3)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin: 0 0 2.5rem;\\n  grid-row: 1;\\n\"])));var ButtonsWrapper=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  grid-row: 2;\\n\"])));var TopRowWrapper=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  grid-row: 3;\\n  display: grid;\\n  grid-template-columns: minmax(36rem, 3.5fr) 1.5fr;\\n  grid-column-gap: 1.25rem;\\n\"])));var SourceRowWrapper=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  overflow-y: overlay;\\n  grid-row: 4;\\n  display: grid;\\n  grid-template-columns: minmax(36rem, 3.5fr) 1.5fr;\\n  grid-column-gap: 1.25rem;\\n\"])));var TabsWrapper=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  * {\\n    align-self: flex-end;\\n  }\\n\"])));var VariablesTitle=styled(H3)(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  align-self: flex-end;\\n\"])));var BreakpointsTitle=styled(H3)(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  margin-bottom: 1rem;\\n\"])));var TxHash=styled.span(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  font-weight: lighter;\\n\"])));var DebugButton=styled(PrimaryButton)(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  width: 4rem;\\n  margin: 0 0.5rem 1rem 0;\\n\"])));var DebugButtonOver=styled(DebugButton)(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  .fa-sync-alt {\\n    max-height: 0.5rem;\\n    overflow: hidden;\\n    position: relative;\\n    top: -0.25rem;\\n    left: 0.2rem;\\n  }\\n\\n  .fa-circle {\\n    position: relative;\\n    top: 0.05rem;\\n    left: -0.48rem;\\n    font-size: 0.35rem;\\n  }\\n\"])));var SourceWrapper=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  grid-column: 1;\\n  display: grid;\\n  overflow-x: auto;\\n  overflow-y: auto;\\n  background: \",\";\\n  border-radius: 1rem;\\n\"])),Colors.CHOCOLATE_200);var RightColumnWrapper=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  grid-column: 2;\\n  display: grid;\\n  grid-template-rows: minmax(30%, 60%) 3rem auto;\\n\"])));var LoadingWrapper=styled(Loading)(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  min-height: 18rem;\\n\"])));var Debugger=function Debugger(_ref){_objectDestructuringEmpty(_ref);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),session=_useState2[0],setSession=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),variables=_useState4[0],setVariables=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),returnValue=_useState6[0],setReturnValue=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),sources=_useState8[0],setSources=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),breakpoints=_useState10[0],setBreakpoints=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),status=_useState12[0],setStatus=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),selectedLine=_useState14[0],setSelectedLine=_useState14[1];var _useState15=useState(0),_useState16=_slicedToArray(_useState15,2),activeLine=_useState16[0],setActiveLine=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),activeTabIndex=_useState18[0],setActiveTabIndex=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),runningTabIndex=_useState20[0],setRunningTabIndex=_useState20[1];var _useParams=useParams(),txHash=_useParams.txHash,port=_useParams.port;var providerUrl=\"http://127.0.0.1:\".concat(port);var transaction={hash:txHash};var provider=Provider.create({url:providerUrl});var start=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,artifacts,input,bugger,initializedSession,sourcesInvolvedInTransaction,sourceIndicesInvolvedInTransaction,sources,currentSource,init;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setVariables(null);setSession(null);setReturnValue(null);setBreakpoints([]);_context.next=6;return axios.get(\"http://127.0.0.1:54321/artifacts\");case 6:res=_context.sent;artifacts=res.data;input={compilations:[]};input.compilations=Codec.Compilations.Utils.shimArtifacts(artifacts);_context.next=12;return TruffleDebugger.forTx(transaction.hash,_objectSpread({provider:provider},input));case 12:bugger=_context.sent;initializedSession=bugger.connect();_context.next=16;return initializedSession.ready();case 16:_context.next=18;return getTransactionSourcesBeforeStarting(bugger);case 18:sourcesInvolvedInTransaction=_context.sent;sourceIndicesInvolvedInTransaction=sourcesInvolvedInTransaction.map(function(source){return parseInt(source.id,10);});sources=input.compilations[0].sources.filter(function(_,index){return sourceIndicesInvolvedInTransaction.includes(index);});setSources(sources);setSession(initializedSession);_context.t0=setVariables;_context.next=26;return initializedSession.variables();case 26:_context.t1=_context.sent;(0,_context.t0)(_context.t1);_context.t2=setReturnValue;_context.next=31;return initializedSession.returnValue();case 31:_context.t3=_context.sent;(0,_context.t2)(_context.t3);_context.t4=setStatus;_context.next=36;return initializedSession.state.evm.transaction.status;case 36:_context.t5=_context.sent;(0,_context.t4)(_context.t5);_context.next=40;return initializedSession.view(TruffleDebugger.selectors.solidity.current.source);case 40:currentSource=_context.sent;setRunningTabIndex(currentSource.ast.id);setActiveTabIndex(currentSource.ast.id);init=initializedSession.view(TruffleDebugger.selectors.solidity.current.sourceRange);setActiveLine(init.lines.start.line);setSelectedLine(init.lines.start.line);case 46:case\"end\":return _context.stop();}}},_callee);}));return function start(){return _ref2.apply(this,arguments);};}();var executeAction=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(debugAction){var source,sourceRange;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!session){_context3.next=40;break;}_context3.t0=debugAction;_context3.next=_context3.t0===\"continueUntil\"?4:_context3.t0===\"over\"?10:_context3.t0===\"into\"?13:_context3.t0===\"out\"?16:19;break;case 4:_context3.next=6;return session.removeAllBreakpoints();case 6:breakpoints.forEach(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(breakpoint){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return session.addBreakpoint(breakpoint);case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref4.apply(this,arguments);};}());_context3.next=9;return session.continueUntilBreakpoint();case 9:return _context3.abrupt(\"break\",20);case 10:_context3.next=12;return session.stepOver();case 12:return _context3.abrupt(\"break\",20);case 13:_context3.next=15;return session.stepInto();case 15:return _context3.abrupt(\"break\",20);case 16:_context3.next=18;return session.stepOut();case 18:return _context3.abrupt(\"break\",20);case 19:return _context3.abrupt(\"break\",20);case 20:_context3.t1=setVariables;_context3.next=23;return session.variables();case 23:_context3.t2=_context3.sent;(0,_context3.t1)(_context3.t2);_context3.t3=setReturnValue;_context3.next=28;return session.returnValue();case 28:_context3.t4=_context3.sent;(0,_context3.t3)(_context3.t4);_context3.next=32;return session.view(TruffleDebugger.selectors.solidity.current.source);case 32:source=_context3.sent;setRunningTabIndex(source.ast.id);setActiveTabIndex(source.ast.id);_context3.next=37;return session.view(TruffleDebugger.selectors.solidity.current.sourceRange);case 37:sourceRange=_context3.sent;setActiveLine(sourceRange.lines.start.line);setSelectedLine(sourceRange.lines.start.line);case 40:case\"end\":return _context3.stop();}}},_callee3);}));return function executeAction(_x){return _ref3.apply(this,arguments);};}();useEffect(function(){start();},[]);return/*#__PURE__*/_jsxs(DebuggerWrapper,{children:[/*#__PURE__*/_jsx(KeyboardShortcuts,{executeAction:executeAction,start:start}),/*#__PURE__*/_jsxs(Header,{children:[/*#__PURE__*/_jsx(StatusIcon,{status:status}),\" \",/*#__PURE__*/_jsxs(TxHash,{children:[\"TX\",\" \",transaction.hash||\"...\"]}),/*#__PURE__*/_jsx(StatusMessage,{returnValue:returnValue})]}),/*#__PURE__*/_jsxs(ButtonsWrapper,{children:[/*#__PURE__*/_jsx(DebugTooltip,{title:\"Continue (F8 or c)\",children:/*#__PURE__*/_jsx(DebugButton,{disabled:!variables,onClick:function onClick(){return executeAction(\"continueUntil\");},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-play\"})})}),/*#__PURE__*/_jsx(DebugTooltip,{title:\"Step Over (F10 or o)\",children:/*#__PURE__*/_jsxs(DebugButtonOver,{onClick:function onClick(){return executeAction(\"over\");},disabled:!variables,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-sync-alt\"}),/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-circle\"})]})}),/*#__PURE__*/_jsx(DebugTooltip,{title:\"Step Into (F11 or i)\",children:/*#__PURE__*/_jsx(DebugButton,{onClick:function onClick(){return executeAction(\"into\");},disabled:!variables,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-to-bottom\"})})}),/*#__PURE__*/_jsx(DebugTooltip,{title:\"Step Out (Shift+F10 or u)\",children:/*#__PURE__*/_jsx(DebugButton,{onClick:function onClick(){return executeAction(\"out\");},disabled:!variables,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-to-top\"})})}),/*#__PURE__*/_jsx(DebugTooltip,{title:\"Restart (r)\",children:/*#__PURE__*/_jsx(DebugButton,{onClick:start,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-redo-alt\"})})})]}),variables?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(TopRowWrapper,{children:[/*#__PURE__*/_jsx(TabsWrapper,{children:/*#__PURE__*/_jsx(Tabs,{sources:sources,setActiveTabIndex:setActiveTabIndex,activeTabIndex:activeTabIndex,runningTabIndex:runningTabIndex})}),/*#__PURE__*/_jsx(VariablesTitle,{children:\"Variables\"})]}),/*#__PURE__*/_jsxs(SourceRowWrapper,{children:[/*#__PURE__*/_jsx(SourceWrapper,{children:/*#__PURE__*/_jsx(Sources,{sources:sources,activeTabIndex:activeTabIndex,activeLine:activeLine,selectedLine:selectedLine,breakpoints:breakpoints,setBreakpoints:setBreakpoints,runningTabIndex:runningTabIndex})}),/*#__PURE__*/_jsxs(RightColumnWrapper,{children:[/*#__PURE__*/_jsx(Variables,{variables:variables}),/*#__PURE__*/_jsx(BreakpointsTitle,{children:\"Breakpoints\"}),/*#__PURE__*/_jsx(Tray,{breakpoints:breakpoints,setBreakpoints:setBreakpoints,setActiveTabIndex:setActiveTabIndex,setSelectedLine:setSelectedLine})]})]})]}):/*#__PURE__*/_jsx(LoadingWrapper,{})]});};export default Debugger;","map":{"version":3,"sources":["/home/warren/environment/consensus bootcamp/truffle-testNft/node_modules/truffle-plugin-debugger/ui/src/components/Debugger.tsx"],"names":["React","useEffect","useState","axios","styled","H3","PrimaryButton","Sources","Variables","Tray","StatusIcon","StatusMessage","Tabs","DebugTooltip","KeyboardShortcuts","List","Colors","Loading","TruffleDebugger","Codec","getTransactionSourcesBeforeStarting","Provider","useParams","DebuggerWrapper","Header","ButtonsWrapper","div","TopRowWrapper","SourceRowWrapper","TabsWrapper","VariablesTitle","BreakpointsTitle","TxHash","span","DebugButton","DebugButtonOver","SourceWrapper","CHOCOLATE_200","RightColumnWrapper","LoadingWrapper","Debugger","session","setSession","variables","setVariables","returnValue","setReturnValue","sources","setSources","breakpoints","setBreakpoints","status","setStatus","selectedLine","setSelectedLine","activeLine","setActiveLine","activeTabIndex","setActiveTabIndex","runningTabIndex","setRunningTabIndex","txHash","port","providerUrl","transaction","hash","provider","create","url","start","get","res","artifacts","data","input","compilations","Compilations","Utils","shimArtifacts","forTx","bugger","initializedSession","connect","ready","sourcesInvolvedInTransaction","sourceIndicesInvolvedInTransaction","map","source","parseInt","id","filter","_","index","includes","state","evm","view","selectors","solidity","current","currentSource","ast","init","sourceRange","lines","line","executeAction","debugAction","removeAllBreakpoints","forEach","breakpoint","addBreakpoint","continueUntilBreakpoint","stepOver","stepInto","stepOut"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport axios from \"axios\";\nimport styled from \"styled-components\";\n\nimport H3 from \"../styles/H3\";\nimport PrimaryButton from \"../styles/PrimaryButton\";\nimport Sources from \"./Sources\";\nimport Variables from \"./Variables\";\nimport Tray from \"./Tray\";\nimport StatusIcon from \"./StatusIcon\";\nimport StatusMessage from \"./StatusMessage\";\nimport Tabs from \"./Tabs\";\nimport DebugTooltip from \"./DebugTooltip\";\nimport KeyboardShortcuts from \"./KeyboardShortcuts\";\nimport List from \"../styles/List\";\nimport * as Colors from \"../styles/colors\";\nimport Loading from \"../styles/Loading\";\n\nimport TruffleDebugger from \"@truffle/debugger\";\nimport * as Codec from \"@truffle/codec\";\nimport { getTransactionSourcesBeforeStarting } from \"@truffle/debug-utils\";\nimport Provider from \"@truffle/provider\";\n\nimport {\n  useParams\n} from \"react-router-dom\";\n\nconst DebuggerWrapper = styled(List)`\n  height: 90vh;\n  display: grid;\n  grid-template-rows: auto auto auto 1fr;\n  grid-template-columns: 1fr;\n  padding: 1rem 2rem;\n`;\n\nconst Header = styled(H3)`\n  margin: 0 0 2.5rem;\n  grid-row: 1;\n`;\n\nconst ButtonsWrapper = styled.div`\n  grid-row: 2;\n`;\n\nconst TopRowWrapper = styled.div`\n  grid-row: 3;\n  display: grid;\n  grid-template-columns: minmax(36rem, 3.5fr) 1.5fr;\n  grid-column-gap: 1.25rem;\n`;\n\nconst SourceRowWrapper = styled.div`\n  overflow-y: overlay;\n  grid-row: 4;\n  display: grid;\n  grid-template-columns: minmax(36rem, 3.5fr) 1.5fr;\n  grid-column-gap: 1.25rem;\n`;\n\nconst TabsWrapper = styled.div`\n  * {\n    align-self: flex-end;\n  }\n`;\n\nconst VariablesTitle = styled(H3)`\n  align-self: flex-end;\n`;\n\nconst BreakpointsTitle = styled(H3)`\n  margin-bottom: 1rem;\n`;\n\nconst TxHash = styled.span`\n  font-weight: lighter;\n`;\n\nconst DebugButton = styled(PrimaryButton)`\n  width: 4rem;\n  margin: 0 0.5rem 1rem 0;\n`;\n\nconst DebugButtonOver = styled(DebugButton)`\n  .fa-sync-alt {\n    max-height: 0.5rem;\n    overflow: hidden;\n    position: relative;\n    top: -0.25rem;\n    left: 0.2rem;\n  }\n\n  .fa-circle {\n    position: relative;\n    top: 0.05rem;\n    left: -0.48rem;\n    font-size: 0.35rem;\n  }\n`;\n\nconst SourceWrapper = styled.div`\n  grid-column: 1;\n  display: grid;\n  overflow-x: auto;\n  overflow-y: auto;\n  background: ${Colors.CHOCOLATE_200};\n  border-radius: 1rem;\n`;\n\nconst RightColumnWrapper = styled.div`\n  grid-column: 2;\n  display: grid;\n  grid-template-rows: minmax(30%, 60%) 3rem auto;\n`;\n\nconst LoadingWrapper = styled(Loading)`\n  min-height: 18rem;\n`;\n\nconst Debugger = ({}) => {\n  const [session, setSession] = useState<null | any>(null);\n  const [variables, setVariables] = useState<null | any>(null);\n  const [returnValue, setReturnValue] = useState<any | any>(null);\n  const [sources, setSources] = useState<any | any>(null);\n  const [breakpoints, setBreakpoints] = useState<any[]>([]);\n  const [status, setStatus] = useState<null | boolean>(null);\n  const [selectedLine, setSelectedLine] = useState<number>(0);\n  const [activeLine, setActiveLine] = useState<number>(0);\n  const [activeTabIndex, setActiveTabIndex] = useState<number>(0);\n  const [runningTabIndex, setRunningTabIndex] = useState<number>(0);\n\n  let { txHash, port } = useParams();\n\n  const providerUrl = `http://127.0.0.1:${port}`;\n  const transaction: any = {\n    hash: txHash\n  };\n\n  const provider = Provider.create({\n    url: providerUrl,\n  });\n\n  const start = async () => {\n    setVariables(null);\n    setSession(null);\n    setReturnValue(null);\n    setBreakpoints([]);\n\n    const res:any = await axios.get(\"http://127.0.0.1:54321/artifacts\")\n    const artifacts: any = res.data;\n\n    const input: {\n      compilations: Codec.Compilations.Compilation[];\n    } = {\n      compilations: [],\n    };\n\n    input.compilations = Codec.Compilations.Utils.shimArtifacts(\n      artifacts\n    );\n\n    const bugger = await TruffleDebugger.forTx(transaction.hash, {\n      provider,\n      ...input\n    });\n\n    const initializedSession = bugger.connect();\n    await initializedSession.ready();\n\n    const sourcesInvolvedInTransaction = await getTransactionSourcesBeforeStarting(\n      bugger\n    );\n\n    const sourceIndicesInvolvedInTransaction = sourcesInvolvedInTransaction.map(\n      (source:any) => {\n        return parseInt(source.id, 10)\n      }\n    );\n\n    const sources = input.compilations[0].sources.filter((_: any, index: any) => {\n      return sourceIndicesInvolvedInTransaction.includes(index)\n    })\n\n    setSources(\n      sources\n    );\n\n    setSession(initializedSession);\n    setVariables(await initializedSession.variables());\n    setReturnValue(await initializedSession.returnValue());\n    setStatus(await initializedSession.state.evm.transaction.status);\n\n    const currentSource = await initializedSession.view(\n      TruffleDebugger.selectors.solidity.current.source\n    );\n    setRunningTabIndex(currentSource.ast.id);\n    setActiveTabIndex(currentSource.ast.id);\n\n    const init = initializedSession.view(\n      TruffleDebugger.selectors.solidity.current.sourceRange\n    );\n\n    setActiveLine(init.lines.start.line);\n    setSelectedLine(init.lines.start.line);\n  };\n\n  const executeAction = async (debugAction: string) => {\n\n    if (session) {\n      switch (debugAction) {\n        case \"continueUntil\": {\n          await session.removeAllBreakpoints();\n          breakpoints.forEach(\n            async breakpoint => await session.addBreakpoint(breakpoint)\n          );\n          await session.continueUntilBreakpoint();\n          break;\n        }\n        case \"over\":\n          await session.stepOver();\n          break;\n        case \"into\":\n          await session.stepInto();\n          break;\n        case \"out\":\n          await session.stepOut();\n          break;\n        default:\n          break;\n      }\n\n      setVariables(await session.variables());\n      setReturnValue(await session.returnValue());\n\n      const source = await session.view(\n        TruffleDebugger.selectors.solidity.current.source\n      );\n      setRunningTabIndex(source.ast.id);\n      setActiveTabIndex(source.ast.id);\n\n      const sourceRange = await session.view(\n        TruffleDebugger.selectors.solidity.current.sourceRange\n      );\n      setActiveLine(sourceRange.lines.start.line);\n      setSelectedLine(sourceRange.lines.start.line);\n    }\n  };\n\n  useEffect(() => {\n    start();\n  }, []);\n\n  return (\n    <DebuggerWrapper>\n      <KeyboardShortcuts executeAction={executeAction} start={start} />\n      <Header>\n        <StatusIcon status={status} />\n        {` `}\n        <TxHash>\n          TX{` `}\n          {transaction.hash || `...`}\n        </TxHash>\n        <StatusMessage returnValue={returnValue} />\n      </Header>\n      <ButtonsWrapper>\n        <DebugTooltip title={`Continue (F8 or c)`}>\n          <DebugButton\n            disabled={!variables}\n            onClick={() => executeAction(\"continueUntil\")}\n          >\n            <i className=\"fas fa-play\" />\n          </DebugButton>\n        </DebugTooltip>\n        <DebugTooltip title={`Step Over (F10 or o)`}>\n          <DebugButtonOver\n            onClick={() => executeAction(\"over\")}\n            disabled={!variables}\n          >\n            <i className=\"fa fa-sync-alt\" />\n            <i className=\"fa fa-circle\" />\n          </DebugButtonOver>\n        </DebugTooltip>\n        <DebugTooltip title={`Step Into (F11 or i)`}>\n          <DebugButton\n            onClick={() => executeAction(\"into\")}\n            disabled={!variables}\n          >\n            <i className=\"fas fa-arrow-to-bottom\" />\n          </DebugButton>\n        </DebugTooltip>\n        <DebugTooltip title={`Step Out (Shift+F10 or u)`}>\n          <DebugButton\n            onClick={() => executeAction(\"out\")}\n            disabled={!variables}\n          >\n            <i className=\"fas fa-arrow-to-top\" />\n          </DebugButton>\n        </DebugTooltip>\n        <DebugTooltip title={`Restart (r)`}>\n          <DebugButton onClick={start}>\n            <i className=\"fas fa-redo-alt\" />\n          </DebugButton>\n        </DebugTooltip>\n      </ButtonsWrapper>\n      {variables ? (\n        <>\n          <TopRowWrapper>\n            <TabsWrapper>\n              <Tabs\n                sources={sources}\n                setActiveTabIndex={setActiveTabIndex}\n                activeTabIndex={activeTabIndex}\n                runningTabIndex={runningTabIndex}\n              />\n            </TabsWrapper>\n            <VariablesTitle>Variables</VariablesTitle>\n          </TopRowWrapper>\n          <SourceRowWrapper>\n            <SourceWrapper>\n              <Sources\n                sources={sources}\n                activeTabIndex={activeTabIndex}\n                activeLine={activeLine}\n                selectedLine={selectedLine}\n                breakpoints={breakpoints}\n                setBreakpoints={setBreakpoints}\n                runningTabIndex={runningTabIndex}\n              />\n            </SourceWrapper>\n            <RightColumnWrapper>\n              <Variables variables={variables} />\n              <BreakpointsTitle>Breakpoints</BreakpointsTitle>\n              <Tray\n                breakpoints={breakpoints}\n                setBreakpoints={setBreakpoints}\n                setActiveTabIndex={setActiveTabIndex}\n                setSelectedLine={setSelectedLine}\n              />\n            </RightColumnWrapper>\n          </SourceRowWrapper>\n        </>\n      ) : (\n        <LoadingWrapper />\n      )}\n    </DebuggerWrapper>\n  );\n};\n\nexport default Debugger;\n"]},"metadata":{},"sourceType":"module"}